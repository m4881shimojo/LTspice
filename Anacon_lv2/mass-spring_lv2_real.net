* C:\Users\shimo\Desktop\LTspice_anacon2025\Anacon_lv2\mass-spring_lv2_real.asc
* Generated by LTspice 24.1.9 for Windows.
R1 out_dx N001 5k
R2 out_x N001 {spring}
R3 N002 N001 1k
R4 N001 out_ddx 1k
X§U1 N001 0 out_ddx opamp Aol=100K GBW=10Meg
X§X1 out_ddx out_dx INT_lv2 params: vol=1
X§X2 out_dx out_x INT_lv2 params: vol=3
V2 0 N002 PULSE(0 -1 5 100n 100n 0.2 10)

* block symbol definitions
.subckt INT_lv2 Int_in Int_out
C1 in0 vout 10µ
R1 in0 Int_in 10k
X§U1 in0 0 vout opamp Aol=10meg GBW=1g
X§U2 N001 N002 Int_out opamp Aol=10meg GBW=1g
R2 Int_out N001 10k
R3 N001 vout 10k
R4 N002 N003 10k
R5 0 N002 10k
V1 N003 0 {vol}
.lib opamp.sub
.param vol=0.0
.IC V(in0)=0
.IC V(out0)=0
.ends INT_lv2

.tran 10
.lib opamp.sub
* 反転増幅器への入力のため、反転する
.param spring=1k
* .step param spring list 1k 3k 7k 10k 15k 20k
* 計算サンプリング期間が自動で決まるようで、振幅が収束してくると時間間隔が長くなり計算精度の低下を招くようだ。
* このため、最大ステップ時間を50μsに設定した
* 質量・ばね・ダンパ系
* PWL(0 0 0.1 0 0.1001 1 0.2 1 0.2001 0)
.backanno
.end
